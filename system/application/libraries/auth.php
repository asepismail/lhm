<?if (!defined('BASEPATH')) exit('No direct script access allowed');class Auth {var $CI;	  function Login()	  {	     $this->CI = &get_instance();	  }      function process_login($login)      {      // cek apakah array login ada array login dikirim dari form login berisi username dan password	      if(!isset($login))	      return FALSE;		      // value dalam array hanya boleh ada 2  tidak lebih dan tidak kurang  		  if(count($login) != 2)	      return FALSE;		      // ambil data dari array	      $username = $login['username'];	      $password = $login['password'];	  	      // cari dalam database	      $this->CI->db->where('LOGINID', $username);	      $this->CI->db->where("USER_PASS=MD5('$password')");	      $query = $this->CI->db->get('m_user'); 		  if ($query->num_rows() == 1)	      {			      foreach ($query->result() as $row)				      {					      $user_id = $row->LOGINID;				      $username = $row->USER_FULLNAME;				      $level = $row->USER_LEVEL;				      $nama = $row->USER_FULLNAME;				      }						      $newdata = array(					      'id' => $user_id,					      'fullname' => $username,					      'level' => $level,					      'full' => $nama			      );						      $this->CI->session->set_userdata($newdata);					      // set session tambahan					      $this->CI->session->set_userdata('logged_user', $username);			      return TRUE;	       }	      else	      {		      // No existing user.		      return FALSE;	      }      }	      function restrict($logged_out = FALSE)		      {		      // fungsi ini untuk mengatur restriction sebuah halaman		      if ($logged_out && $this->logged_in())		      {			      // jika user sudah login tetapi ingin melihat halamann yang tidak seharusnya dilihat, contoh halaman login			      redirect('tes'); // url helper, pastikan sudah ter-load		      }				      if ( ! $logged_out && ! $this->logged_in())		      {			      // jika user sudah logout (default :FALSE) dan dia ingin masuk halaman admin			      redirect('login');		      }		      }	      function logged_in()		      {			      if ($this->CI->session->userdata('logged_user') == FALSE)		      {		      		return FALSE;		      } else {			      return TRUE;			  }		      }	      function logout()		      {		      $this->CI->session->sess_destroy();		      return TRUE;	      }	      function cek($idmenu)		      {			      // untuk mengecek apakah user mempunyai hak akses atau tidak				      $status_user=$this->CI->session->userdata('level');				      $this->db->select('menu_level');				      $this->db->from('menu');				      $this->db->where('menu_id',$id);				      $data = $this->db->get();				      $row=$data->row();				      $lev=$row->menu_level;		      $arr=explode('+',$lev);				      if(in_array($status_user,$arr)==FALSE)				      {				      redirect('home');				      }		      } }?>
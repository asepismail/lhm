<?class model_rpt_lhm extends Model {    function model_rpt_lhm()    {        parent::Model(); 		$this->load->database();		$this->load->plugin('to_excel');    }		function generate_lhm($company, $from, $to){		$sql = "SELECT gad.LHM_DATE, gad.GANG_CODE, g.DESCRIPTION, g.MANDORE_CODE, emp1.NAMA, gad.EMPLOYEE_CODE, emp2.NAMA, gad.TYPE_ABSENSI,	gad.LOCATION_TYPE_CODE, gad.LOCATION_CODE, loc.DESCRIPTION, gad.ACTIVITY_CODE, coa.COA_DESCRIPTION, gad.HK_JUMLAH, gad.HSL_KERJA_UNIT, gad.HSL_KERJA_VOLUME,	gad.TARIF_SATUAN, gad.PREMI, gad.LEMBUR_JAM, gad.PENALTI, gad.COMPANY_CODE FROM m_gang_activity_detail gadLEFT JOIN m_gang g ON (g.COMPANY_CODE = gad.COMPANY_CODE AND g.GANG_CODE = gad.GANG_CODE)LEFT JOIN m_employee emp1 ON (emp1.COMPANY_CODE = gad.COMPANY_CODE AND emp1.NIK = g.MANDORE_CODE)LEFT JOIN m_employee emp2 ON (emp2.COMPANY_CODE = gad.COMPANY_CODE AND emp2.NIK = gad.EMPLOYEE_CODE)LEFT JOIN ( SELECT LOCATION_CODE, DESCRIPTION FROM m_location WHERE company_code = '".$company."' ) loc ON ( loc.LOCATION_CODE = gad.LOCATION_CODE ) LEFT JOIN m_coa coa ON (coa.ACCOUNTCODE = gad.ACTIVITY_CODE)WHERE gad.COMPANY_CODE = '".$company."' AND DATE_FORMAT(gad.LHM_DATE,'%Y%m%d') BETWEEN '".$from."' AND '".$to."'";		$query = $this->db->query($sql);				$temp = $query->row_array();		$temp_result = array(); 				foreach ( $query->result_array() as $row )		{			$temp_result [] = $row;		}		$this->db->close();		return $temp_result;	}	/*		get_salary Added By Asep, 20130730		used to get data salary   	*/	function get_salary($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_gaji('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		/*		get_hkne Added By Asep, 20130730		used to get data hkne	*/	function get_hkne($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_hkne('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		/*		get_premi Added By Asep, 20130730		used to get data premi	*/	function get_premi($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_premilembur('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		/*		get_natura Added By Asep, 20130730		used to get data natura	*/	function get_natura($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_natura('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		/*		get_astek Added By Asep, 20130730		used to get data astek	*/	function get_astek($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_astek('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		/*		get_rapel Added By Asep, 20130730		used to get data rapel	*/	function get_rapel($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_rapel('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		function get_thr($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_thr('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		function get_tunjangan_lain($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_tunjlain('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}				$this->db->close();		return $temp_result;	}		function get_potastek($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_potastek('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		function get_pph($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_pph('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		function get_zakat($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_zakat('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;                            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}		function get_bpjs($company, $period){		$sQuery = $this->db->query("CALL sp_new_adem_bpjs('".$company."','".$period."')");			$numrows = $sQuery->num_rows();        if ($numrows > 0){        	$temp = $sQuery->row_array();            $temp_result = array();             foreach ( $sQuery->result_array() as $row )            {                $temp_result [] = $row;            }		}else{			$temp_result = NULL;			}		$this->db->close();		return $temp_result;	}}?>